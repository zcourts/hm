
;; value restriction issue

(def push
  (lambda (x value)
          (do
            (with x)
            (set x (cons value (get x))))))

(def x (ref nil))

(push x 1)
;;(push x 2)


(def func-ref
  (lambda (x)
          (let r (ref x)
               (lambda (z)
                       (do
                         (with r)
                         (set r z))))))

(def l (cons 1 nil))
(def b (cons true nil))
(def bob (func-ref nil))

(bob l)
(bob b)
;; (bob true)

;; (do 
;;   (with r)
;;   (set r z))))))

